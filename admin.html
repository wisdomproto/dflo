<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#14b8a6">
    <title>ÌôòÏûê Í¥ÄÎ¶¨ - 187 ÏÑ±Ïû•ÏºÄÏñ¥</title>
    <link rel="stylesheet" href="css/mobile.css">
    <link rel="stylesheet" href="css/admin-patients.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Ïï± Ìó§Îçî -->
    <header class="app-header">
        <button class="btn-back" onclick="location.href='index.html'">‚Üê Ìôà</button>
        <div class="app-header-content">
            <div class="app-title">
                <h1>üë• ÌôòÏûê Í¥ÄÎ¶¨</h1>
                <p>Ïó∞ÏÑ∏ÏÉàÎ¥ÑÏùòÏõê ÏÑ±Ïû• ÌÅ¥Î¶¨Îãâ</p>
            </div>
        </div>
    </header>

    <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
    <main class="main-content">
        <div class="container">
            <!-- Í≤ÄÏÉâ & ÌïÑÌÑ∞ -->
            <div class="search-section">
                <div class="search-box">
                    <input type="text" id="patientSearch" placeholder="üîç ÌôòÏûêÎ™Ö ÎòêÎäî Ï∞®Ìä∏Î≤àÌò∏Î°ú Í≤ÄÏÉâ..." oninput="searchPatients()">
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterPatients('all')">Ï†ÑÏ≤¥</button>
                    <button class="filter-btn" onclick="filterPatients('male')">ÎÇ®ÏïÑ</button>
                    <button class="filter-btn" onclick="filterPatients('female')">Ïó¨ÏïÑ</button>
                    <button class="filter-btn" onclick="filterPatients('ongoing')">ÏπòÎ£åÏ§ë</button>
                </div>
            </div>

            <!-- ÌôòÏûê Î™©Î°ù ÏÑπÏÖò -->
            <div id="patientsSection" class="admin-section active">
                <div class="card">
                    <div class="section-header">
                        <div class="stats-summary">
                            <div class="stat-item">
                                <span class="stat-label">Ï†ÑÏ≤¥ ÌôòÏûê</span>
                                <span class="stat-value" id="totalPatients">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">ÏπòÎ£åÏ§ë</span>
                                <span class="stat-value" id="ongoingPatients">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">ÎÇ®ÏïÑ</span>
                                <span class="stat-value" id="malePatients">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Ïó¨ÏïÑ</span>
                                <span class="stat-value" id="femalePatients">0</span>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showAddPatientModal()">
                            ‚ûï ÏÉà ÌôòÏûê Îì±Î°ù
                        </button>
                    </div>
                    <div id="patientsList" class="patients-list"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- ÌôòÏûê Ï∂îÍ∞Ä/ÏàòÏ†ï Î™®Îã¨ -->
    <div id="patientModal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="patientModalTitle">ÌôòÏûê Îì±Î°ù</h3>
                <button class="btn-close" onclick="closePatientModal()">‚úï</button>
            </div>
            <form id="patientForm" onsubmit="savePatient(event)">
                <input type="hidden" id="patientId">
                
                <!-- Í∏∞Î≥∏ Ï†ïÎ≥¥ -->
                <div class="form-section">
                    <h4>üë§ Í∏∞Î≥∏ Ï†ïÎ≥¥</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patientName"><span class="required">*</span> Ïù¥Î¶Ñ</label>
                            <input type="text" id="patientName" required placeholder="ÌôçÍ∏∏Îèô">
                        </div>
                        <div class="form-group">
                            <label for="patientGender"><span class="required">*</span> ÏÑ±Î≥Ñ</label>
                            <select id="patientGender" required>
                                <option value="">ÏÑ†ÌÉù</option>
                                <option value="male">ÎÇ®ÏïÑ</option>
                                <option value="female">Ïó¨ÏïÑ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="patientBirthDate"><span class="required">*</span> ÏÉùÎÖÑÏõîÏùº</label>
                            <input type="date" id="patientBirthDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="chartNumber">Ï∞®Ìä∏Î≤àÌò∏</label>
                            <input type="text" id="chartNumber" placeholder="ÏûêÎèô ÏÉùÏÑ±">
                        </div>
                        <div class="form-group">
                            <label for="parentPhone">Ïó∞ÎùΩÏ≤ò</label>
                            <input type="tel" id="parentPhone" placeholder="010-1234-5678">
                        </div>
                    </div>
                </div>

                <!-- Î∂ÄÎ™® Ï†ïÎ≥¥ -->
                <div class="form-section">
                    <h4>üë®‚Äçüë©‚Äçüëß Î∂ÄÎ™® Ï†ïÎ≥¥</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fatherHeight">ÏïÑÎ≤ÑÏßÄ ÌÇ§ (cm)</label>
                            <input type="number" id="fatherHeight" step="0.1" placeholder="175.0">
                        </div>
                        <div class="form-group">
                            <label for="motherHeight">Ïñ¥Î®∏Îãà ÌÇ§ (cm)</label>
                            <input type="number" id="motherHeight" step="0.1" placeholder="160.0">
                        </div>
                        <div class="form-group">
                            <label for="targetHeight">Ìù¨Îßù ÌÇ§ (cm)</label>
                            <input type="number" id="targetHeight" step="0.1" placeholder="180.0">
                        </div>
                    </div>
                </div>

                <!-- ÌäπÏù¥ÏÇ¨Ìï≠ -->
                <div class="form-section">
                    <h4>üìù ÌäπÏù¥ÏÇ¨Ìï≠</h4>
                    <div class="form-group">
                        <textarea id="specialNotes" rows="3" placeholder="ÏïåÎ†àÎ•¥Í∏∞, Í≥ºÍ±∞ Î≥ëÎ†•, Ï£ºÏùòÏÇ¨Ìï≠ Îì±"></textarea>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closePatientModal()">Ï∑®ÏÜå</button>
                    <button type="submit" class="btn btn-primary">Ï†ÄÏû•</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ÌôòÏûê ÏÉÅÏÑ∏ Î≥¥Í∏∞ Î™®Îã¨ -->
    <div id="patientDetailModal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="patientDetailTitle">ÌôòÏûê ÏÉÅÏÑ∏ Ï†ïÎ≥¥</h3>
                <button class="btn-close" onclick="closePatientDetailModal()">‚úï</button>
            </div>
            
            <div class="tabs">
                <button class="tab-btn active" onclick="switchDetailTab('info')">Í∏∞Î≥∏Ï†ïÎ≥¥</button>
                <button class="tab-btn" onclick="switchDetailTab('records')">Ï∏°Ï†ïÍ∏∞Î°ù</button>
                <button class="tab-btn" onclick="switchDetailTab('chart')">ÏÑ±Ïû•Ï∞®Ìä∏</button>
            </div>

            <!-- Í∏∞Î≥∏Ï†ïÎ≥¥ ÌÉ≠ -->
            <div id="infoTab" class="tab-content active">
                <div id="patientDetailInfo"></div>
            </div>

            <!-- Ï∏°Ï†ïÍ∏∞Î°ù ÌÉ≠ -->
            <div id="recordsTab" class="tab-content">
                <div class="records-header">
                    <h4>üìè Ï∏°Ï†ï Í∏∞Î°ù</h4>
                    <button class="btn btn-sm btn-primary" onclick="showAddRecordModal()">
                        ‚ûï Ï∏°Ï†ï Ï∂îÍ∞Ä
                    </button>
                </div>
                <div id="recordsList"></div>
            </div>

            <!-- ÏÑ±Ïû•Ï∞®Ìä∏ ÌÉ≠ -->
            <div id="chartTab" class="tab-content">
                <h4>üìä ÏÑ±Ïû• Í≥°ÏÑ†</h4>
                <div class="chart-wrapper">
                    <canvas id="patientGrowthChart"></canvas>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closePatientDetailModal()">Îã´Í∏∞</button>
                <button type="button" class="btn btn-primary" onclick="editPatient()">ÏàòÏ†ï</button>
                <button type="button" class="btn btn-danger" onclick="deletePatient()">ÏÇ≠Ï†ú</button>
            </div>
        </div>
    </div>

    <!-- Ï∏°Ï†ï Í∏∞Î°ù Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div id="recordModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ï∏°Ï†ï Í∏∞Î°ù Ï∂îÍ∞Ä</h3>
                <button class="btn-close" onclick="closeRecordModal()">‚úï</button>
            </div>
            <form id="recordForm" onsubmit="saveRecord(event)">
                <input type="hidden" id="recordPatientId">
                <input type="hidden" id="recordId">
                
                <div class="form-group">
                    <label for="recordDate"><span class="required">*</span> Ï∏°Ï†ïÏùº</label>
                    <input type="date" id="recordDate" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="recordHeight"><span class="required">*</span> ÌÇ§ (cm)</label>
                        <input type="number" id="recordHeight" step="0.1" required placeholder="165.0">
                    </div>
                    <div class="form-group">
                        <label for="recordWeight"><span class="required">*</span> Î™∏Î¨¥Í≤å (kg)</label>
                        <input type="number" id="recordWeight" step="0.1" required placeholder="55.0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="boneAge">ÎºàÎÇòÏù¥ (ÏÑ∏)</label>
                        <input type="number" id="boneAge" step="0.1" placeholder="12.5">
                    </div>
                    <div class="form-group">
                        <label for="predictedHeight">ÏòàÏ∏° ÏµúÏ¢ÖÌÇ§ (cm)</label>
                        <input type="number" id="predictedHeight" step="0.1" placeholder="175.0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="recordMemo">Î©îÎ™®</label>
                    <textarea id="recordMemo" rows="3" placeholder="Ï∏°Ï†ï ÏÜåÍ≤¨, ÌäπÏù¥ÏÇ¨Ìï≠ Îì±"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeRecordModal()">Ï∑®ÏÜå</button>
                    <button type="submit" class="btn btn-primary">Ï†ÄÏû•</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/growth-data.js"></script>
    <script src="js/admin-patients.js"></script>
</body>
</html>
