#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ì—‘ì…€ LMS ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë³€í™˜
"""

import json

# ì‚¬ìš©ìê°€ ì œê³µí•œ ì •í™•í•œ LMS ë°ì´í„°
raw_data = """1	0	0	1.0000 	49.8842 	0.0380 
1		1	1.0000 	54.7244 	0.0356 
1		2	1.0000 	58.4249 	0.0342 
1		3	1.0000 	61.4292 	0.0333 
1		4	1.0000 	63.8860 	0.0326 
1		5	1.0000 	65.9026 	0.0320 
1		6	1.0000 	67.6236 	0.0317 
1		7	1.0000 	69.1645 	0.0314 
1		8	1.0000 	70.5994 	0.0312 
1		9	1.0000 	71.9687 	0.0312 
1		10	1.0000 	73.2812 	0.0312 
1		11	1.0000 	74.5388 	0.0313 
1	1	12	1.0000 	75.7488 	0.0314 
1		13	1.0000 	76.9186 	0.0315 
1		14	1.0000 	78.0497 	0.0317 
1		15	1.0000 	79.1458 	0.0320 
1		16	1.0000 	80.2113 	0.0322 
1		17	1.0000 	81.2487 	0.0325 
1		18	1.0000 	82.2587 	0.0328 
1		19	1.0000 	83.2418 	0.0331 
1		20	1.0000 	84.1996 	0.0334 
1		21	1.0000 	85.1348 	0.0338 
1		22	1.0000 	86.0477 	0.0341 
1		23	1.0000 	86.9410 	0.0345 
1	2	24	1.0000 	87.1161 	0.0351 
1		25	1.0000 	87.9720 	0.0354 
1		26	1.0000 	88.8065 	0.0358 
1		27	1.0000 	89.6197 	0.0361 
1		28	1.0000 	90.4120 	0.0364 
1		29	1.0000 	91.1828 	0.0367 
1		30	1.0000 	91.9327 	0.0370 
1		31	1.0000 	92.6631 	0.0373 
1		32	1.0000 	93.3753 	0.0376 
1		33	1.0000 	94.0711 	0.0379 
1		34	1.0000 	94.7532 	0.0381 
1		35	1.0000 	95.4236 	0.0384 
1	3	36	-1.0915 	96.4961 	0.0403 
1		37	-1.0011 	97.0464 	0.0403 
1		38	-0.9126 	97.5965 	0.0402 
1		39	-0.8262 	98.1463 	0.0402 
1		40	-0.7418 	98.6959 	0.0402 
1		41	-0.6592 	99.2452 	0.0402 
1		42	-0.5827 	99.7930 	0.0401 
1		43	-0.5077 	100.3406 	0.0401 
1		44	-0.4343 	100.8881 	0.0401 
1		45	-0.3625 	101.4353 	0.0401 
1		46	-0.2921 	101.9824 	0.0401 
1		47	-0.2232 	102.5294 	0.0400 
1	4	48	-0.1597 	103.0749 	0.0400 
1		49	-0.0975 	103.6204 	0.0400 
1		50	-0.0364 	104.1657 	0.0400 
1		51	0.0234 	104.7109 	0.0399 
1		52	0.0822 	105.2560 	0.0399 
1		53	0.1398 	105.8009 	0.0399 
1		54	0.1897 	106.3440 	0.0399 
1		55	0.2387 	106.8869 	0.0399 
1		56	0.2868 	107.4298 	0.0398 
1		57	0.3341 	107.9726 	0.0398 
1		58	0.3805 	108.5153 	0.0398 
1		59	0.4261 	109.0579 	0.0398 
1	5	60	0.4242 	109.5896 	0.0398 
1		61	0.4223 	110.1212 	0.0399 
1		62	0.4205 	110.6529 	0.0399 
1		63	0.4187 	111.1846 	0.0399 
1		64	0.4169 	111.7162 	0.0400 
1		65	0.4151 	112.2479 	0.0400 
1		66	0.3787 	112.7735 	0.0400 
1		67	0.3429 	113.2990 	0.0401 
1		68	0.3074 	113.8245 	0.0401 
1		69	0.2724 	114.3501 	0.0402 
1		70	0.2378 	114.8756 	0.0402 
1		71	0.2036 	115.4010 	0.0403 
1	6	72	0.1783 	115.9183 	0.0403 
1		73	0.1533 	116.4356 	0.0404 
1		74	0.1287 	116.9528 	0.0404 
1		75	0.1044 	117.4701 	0.0405 
1		76	0.0805 	117.9874 	0.0405 
1		77	0.0569 	118.5047 	0.0406 
1		78	0.0563 	119.0136 	0.0406 
1		79	0.0557 	119.5225 	0.0406 
1		80	0.0552 	120.0314 	0.0406 
1		81	0.0546 	120.5404 	0.0406 
1		82	0.0541 	121.0493 	0.0406 
1		83	0.0536 	121.5582 	0.0406 
1	7	84	0.0492 	122.0537 	0.0406 
1		85	0.0448 	122.5492 	0.0406 
1		86	0.0405 	123.0447 	0.0406 
1		87	0.0363 	123.5402 	0.0406 
1		88	0.0321 	124.0357 	0.0406 
1		89	0.0280 	124.5313 	0.0406 
1		90	0.0397 	125.0114 	0.0406 
1		91	0.0514 	125.4914 	0.0405 
1		92	0.0628 	125.9715 	0.0405 
1		93	0.0741 	126.4515 	0.0405 
1		94	0.0853 	126.9316 	0.0405 
1		95	0.0964 	127.4116 	0.0405 
1	8	96	0.1205 	127.8793 	0.0405 
1		97	0.1443 	128.3469 	0.0404 
1		98	0.1679 	128.8145 	0.0404 
1		99	0.1912 	129.2821 	0.0404 
1		100	0.2142 	129.7497 	0.0404 
1		101	0.2370 	130.2172 	0.0404 
1		102	0.2339 	130.6754 	0.0404 
1		103	0.2308 	131.1336 	0.0404 
1		104	0.2278 	131.5919 	0.0404 
1		105	0.2248 	132.0501 	0.0404 
1		106	0.2218 	132.5084 	0.0404 
1		107	0.2188 	132.9666 	0.0404 
1	9	108	0.1885 	133.4136 	0.0405 
1		109	0.1585 	133.8606 	0.0406 
1		110	0.1288 	134.3076 	0.0406 
1		111	0.0994 	134.7545 	0.0407 
1		112	0.0704 	135.2014 	0.0408 
1		113	0.0416 	135.6482 	0.0409 
1		114	0.0210 	136.1026 	0.0410 
1		115	0.0008 	136.5569 	0.0411 
1		116	-0.0191 	137.0113 	0.0412 
1		117	-0.0386 	137.4656 	0.0414 
1		118	-0.0579 	137.9199 	0.0415 
1		119	-0.0768 	138.3742 	0.0416 
1	10	120	-0.0752 	138.8473 	0.0417 
1		121	-0.0736 	139.3205 	0.0419 
1		122	-0.0720 	139.7936 	0.0420 
1		123	-0.0705 	140.2667 	0.0422 
1		124	-0.0689 	140.7398 	0.0423 
1		125	-0.0674 	141.2130 	0.0424 
1		126	-0.0489 	141.7059 	0.0426 
1		127	-0.0308 	142.1987 	0.0428 
1		128	-0.0131 	142.6916 	0.0430 
1		129	0.0041 	143.1844 	0.0432 
1		130	0.0209 	143.6773 	0.0434 
1		131	0.0373 	144.1701 	0.0436 
1	11	132	0.0886 	144.7010 	0.0438 
1		133	0.1383 	145.2319 	0.0441 
1		134	0.1864 	145.7627 	0.0443 
1		135	0.2331 	146.2935 	0.0445 
1		136	0.2784 	146.8242 	0.0448 
1		137	0.3223 	147.3549 	0.0450 
1		138	0.4064 	147.9321 	0.0453 
1		139	0.4882 	148.5094 	0.0455 
1		140	0.5676 	149.0866 	0.0457 
1		141	0.6448 	149.6638 	0.0459 
1		142	0.7199 	150.2409 	0.0462 
1		143	0.7929 	150.8180 	0.0464 
1	12	144	0.8928 	151.4223 	0.0465 
1		145	0.9910 	152.0268 	0.0466 
1		146	1.0877 	152.6312 	0.0467 
1		147	1.1829 	153.2358 	0.0468 
1		148	1.2764 	153.8404 	0.0469 
1		149	1.3684 	154.4450 	0.0470 
1		150	1.4580 	155.0459 	0.0469 
1		151	1.5475 	155.6468 	0.0469 
1		152	1.6370 	156.2477 	0.0468 
1		153	1.7263 	156.8487 	0.0467 
1		154	1.8155 	157.4497 	0.0466 
1		155	1.9045 	158.0507 	0.0465 
1	13	156	2.0111 	158.6245 	0.0463 
1		157	2.1194 	159.1984 	0.0460 
1		158	2.2294 	159.7724 	0.0457 
1		159	2.3410 	160.3465 	0.0454 
1		160	2.4544 	160.9207 	0.0452 
1		161	2.5694 	161.4949 	0.0449 
1		162	2.6754 	162.0038 	0.0445 
1		163	2.7844 	162.5128 	0.0440 
1		164	2.8966 	163.0218 	0.0436 
1		165	3.0121 	163.5308 	0.0431 
1		166	3.1309 	164.0398 	0.0427 
1		167	3.2531 	164.5488 	0.0423 
1	14	168	3.3119 	164.9650 	0.0417 
1		169	3.3725 	165.3813 	0.0412 
1		170	3.4351 	165.7975 	0.0407 
1		171	3.4998 	166.2138 	0.0402 
1		172	3.5666 	166.6301 	0.0397 
1		173	3.6357 	167.0464 	0.0392 
1		174	3.6315 	167.3647 	0.0388 
1		175	3.6262 	167.6831 	0.0384 
1		176	3.6198 	168.0013 	0.0379 
1		177	3.6121 	168.3195 	0.0375 
1		178	3.6031 	168.6377 	0.0370 
1		179	3.5927 	168.9558 	0.0366 
1	15	180	3.5208 	169.1812 	0.0363 
1		181	3.4457 	169.4066 	0.0360 
1		182	3.3672 	169.6319 	0.0357 
1		183	3.2853 	169.8571 	0.0353 
1		184	3.1997 	170.0824 	0.0350 
1		185	3.1104 	170.3076 	0.0347 
1		186	2.9809 	170.4684 	0.0345 
1		187	2.8483 	170.6294 	0.0342 
1		188	2.7127 	170.7906 	0.0340 
1		189	2.5740 	170.9520 	0.0338 
1		190	2.4321 	171.1137 	0.0335 
1		191	2.2872 	171.2756 	0.0333 
1	16	192	2.1540 	171.3949 	0.0332 
1		193	2.0196 	171.5145 	0.0330 
1		194	1.8841 	171.6344 	0.0328 
1		195	1.7474 	171.7546 	0.0327 
1		196	1.6096 	171.8752 	0.0325 
1		197	1.4707 	171.9960 	0.0324 
1		198	1.3966 	172.0897 	0.0323 
1		199	1.3226 	172.1836 	0.0323 
1		200	1.2488 	172.2775 	0.0322 
1		201	1.1751 	172.3716 	0.0322 
1		202	1.1016 	172.4658 	0.0321 
1		203	1.0282 	172.5600 	0.0321 
1	17	204	0.9751 	172.6404 	0.0321 
1		205	0.9218 	172.7207 	0.0321 
1		206	0.8685 	172.8009 	0.0321 
1		207	0.8150 	172.8812 	0.0321 
1		208	0.7614 	172.9614 	0.0321 
1		209	0.7077 	173.0416 	0.0321 
1		210	0.6595 	173.1222 	0.0321 
1		211	0.6110 	173.2027 	0.0321 
1		212	0.5623 	173.2832 	0.0321 
1		213	0.5134 	173.3636 	0.0320 
1		214	0.4642 	173.4440 	0.0320 
1		215	0.4148 	173.5244 	0.0320 
1	18	216	0.3638 	173.6037 	0.0320 
1		217	0.3126 	173.6830 	0.0320 
1		218	0.2611 	173.7622 	0.0320 
1		219	0.2094 	173.8413 	0.0320 
1		220	0.1573 	173.9204 	0.0320 
1		221	0.1050 	173.9995 	0.0320 
1		222	0.0449 	174.0764 	0.0320 
1		223	-0.0155 	174.1532 	0.0320 
1		224	-0.0764 	174.2300 	0.0320 
1		225	-0.1377 	174.3067 	0.0319 
1		226	-0.1994 	174.3833 	0.0319 
1		227	-0.2615 	174.4598 	0.0319"""

# ë°ì´í„° íŒŒì‹±
lines = raw_data.strip().split('\n')
male_height = []
last_year = None

for line in lines:
    parts = [p.strip() for p in line.split('\t') if p.strip()]
    
    gender = int(parts[0])
    if gender != 1:  # ë‚¨ì•„ë§Œ ì²˜ë¦¬
        continue
        
    # ì—°ë„ì™€ ê°œì›” íŒŒì‹±
    if len(parts) >= 3 and parts[1]:  # ì—°ë„ ìˆìŒ
        year = int(parts[1])
        month = int(parts[2])
        last_year = year
    else:  # ì—°ë„ ì—†ìŒ, ì´ì „ ì—°ë„ ì‚¬ìš©
        month = int(parts[1])
        year = last_year
    
    # LMS ê°’
    L = float(parts[-3])
    M = float(parts[-2])
    S = float(parts[-1])
    
    # age ê³„ì‚° (ì—° ë‹¨ìœ„)
    age = round(year + month / 12, 2)
    
    male_height.append({
        "age": age,
        "L": L,
        "M": M,
        "S": S
    })

print(f"âœ… ë‚¨ì•„ ì‹ ì¥ ë°ì´í„° {len(male_height)}ê°œ ìƒì„±")
print(f"ğŸ“Š ìƒ˜í”Œ: {male_height[132:135]}")  # 11ì„¸ ë°ì´í„°

# JSON ìƒì„±
output = {
    "metadata": {
        "source": "ëŒ€í•œì†Œì•„ê³¼í•™íšŒ 2017 í•œêµ­ ì†Œì•„ì²­ì†Œë…„ ì„±ì¥ë„í‘œ",
        "method": "LMS",
        "description": "Lambda-Mu-Sigma ë°©ë²•ì„ ì‚¬ìš©í•œ í•œêµ­ í‘œì¤€ ì„±ì¥ ë°ì´í„° (ì •í™•í•œ ê°œì›” ë‹¨ìœ„)",
        "ageUnit": "years",
        "heightUnit": "cm",
        "weightUnit": "kg"
    },
    "male": {
        "height": male_height
    }
}

# íŒŒì¼ ì €ì¥
with open('../data/korea_growth_standard_new.json', 'w', encoding='utf-8') as f:
    json.dump(output, f, ensure_ascii=False, indent=2)

print("âœ… JSON íŒŒì¼ ìƒì„± ì™„ë£Œ: data/korea_growth_standard_new.json")
